#include <stdio.h>
#include <stdlib.h>
#include <time.h>
#include <string.h>
#include <conio.h>

#define OK 1
#define ERROR 1
//对答案的链表

typedef int Status;

//链表中的结点
typedef struct AnswerNode{
    long int number;         //题号（可能有一万道题）
    struct AnswerNode *next;     //下一道题
}AnswerNode, *AnswerList;

//正确题和错误题链表的结点中的number域
long int StrToInt(char *String) {
    int i,j,pro=1;
    long int Count = 0;       //count有可能达到10000
    char temp;
    char *p;
    p = String;
    for(j=0;j<strlen(String);j++)
    {
        pro*=10;    //pro初始化
    }

    for(i=0;i<strlen(String);i++)
    {
        temp = *p;
        pro/= 10;
        Count += (temp-48) * pro;
        p++;
    }
    return Count;
}

//初始化正确题、错误题的链表
Status InitAnswerList(AnswerList &L) {
    L = (AnswerNode*)malloc(sizeof(AnswerNode));
    if(L == NULL) return ERROR;
  //  L->number = 0;
    L->next = NULL;
    return OK;
}

//创建链表的结点
AnswerList CreateAnswerNode(char *String) {
    AnswerNode *p;
    p = (AnswerNode*)malloc(sizeof(AnswerNode));
    if(p != NULL)
    {
        p->number = StrToInt(String);
        p->next = NULL;
    }

    return p;
}

//把结点插入表尾
Status InsertInList(AnswerList &A, AnswerList a) {
    AnswerNode *p;
    p = A;
    if(a == NULL)  return ERROR;
    while(p->next != NULL)
    {
        p = p->next;
    }
    //此时p已经到链表A的末尾
    p->next = a;
    return OK;
}

//访问链表并输出题号
void visitAnswerList(AnswerList A) {
    AnswerList p;
    p = A->next;
    if(p!=NULL)
    {
        printf("(");
        while(p->next!=NULL)
        {
            printf("%ld,",p->number);
            p = p->next;
        }
        printf("%ld)",p->number);
    }

}

Status checkAnswer(){
    char student[30];
    char answer[30];      //s用来存储学生答案的文件名（含后缀）
    printf("---------------------------------------------IMPORTANT!!!!-----------------------------------------------\n");
    printf("****************************请先将学生答案放入文件夹的根目录下再进行下述操作*****************************\n");
    printf("\n请输入学生答案的文件名（附文件后缀名）：");
    scanf("%s",student);//学生答案的文件名
 //   printf("\n请输入标准答案的文件名（附文件后缀名）：");
 //   scanf("%s",answer);


    FILE *fpStudent = fopen(student,"r");       //读学生答案
    if(fpStudent == NULL)      //无法读取文件的异常情况
    {
        printf("\n无法读取学生的答案文件，请重试！\n");
        getchar();
        exit(1);
    }
    //默认标准答案的文件名为answer.txt
    FILE *fpAnswer = fopen("answer.txt","r");         //读标准答案
    if(fpAnswer == NULL)
    {
        printf("\n无法读取标准答案的文件，请重试！\n");
        getchar();
        exit(1);
    }

    int CorrectNum = 0,WrongNum = 0;
    int control1 = 0,control2 = 0,control3 = 0;  //control1:wrongList,control2:correctList,control3:modifyList,control4:lackList
    char *p, *q;    //p指针用来遍历学生答案，q指针用来遍历标准答案
    char *p1, *q1, *p2;
    char temp[30]={0};
    char temp1[30]={0};
    char temp2[30]={0};
    char temp3[30] = {0};
    AnswerList wrongList,correctList,modifyList;
    InitAnswerList(wrongList);    //初始化错误题目的链表
    InitAnswerList(correctList);  //初始化正确题目的链表
    InitAnswerList(modifyList);   //初始化需要修改题目的链表
    char string1[30], string2[30],string3[30], string4[30];

    if(fgetc(fpStudent) == EOF)
    {
        printf("\n学生答案的文件是一个空文件！\n");
        fclose(fpStudent);
        return 0;
    }
    if(fgetc(fpAnswer) == EOF)
    {
        printf("\n标准答案的文件是一个空文件！\n");
        fclose(fpAnswer);
        return 0;
    }
    rewind(fpStudent);    //回到文件开头
    rewind(fpAnswer);
    //循环直至读到文件末尾

    /*
    首先对题号进行校对，可能会有漏题、或者题号错误的情况，如果题号出错，直接return
    */

    while(!feof(fpStudent) && !feof(fpAnswer))
    {
        if(fgets(string3,15,fpStudent)==NULL)
            printf("error in string3\n");     //把学生答案里的数据读出来存取进字符串string3，且每次读取一行
		if(fgets(string4,15,fpAnswer)==NULL)
            printf("error in string4\n");      //把答案中第一行的数据读出来并存进字符串string2中
		p1 = string3;   //p1指向string3
		q1 = string4;   //q1指向string4
		while(*p1!='.')
        {
            if(*p1 == *q1)
            {
                p1++;
                q1++;
            }
            else {      //学生答案中的数字与标准答案的题号对不上（漏题或题号对应错）
                p2 = string3;
                control3 = 0;
                while(*p2!='.')
                {
                    control3++;
                    p2++;
                }
            strncpy(temp2,string3,control3);
            //将.之前的字符转换成字符串再变成int，赋给链表的结点
            InsertInList(modifyList,CreateAnswerNode(temp2));       //将新结点插入错误链表中
            p1++;
            q1++;
            }
        }

     /*   if(*p1=='.' && *q1!='.')
        {

            printf("\n学生答案题号有误，可能原因：题号有跳跃或题号对应错误！出现错误的题号如下：\n");
            visitAnswerList(modifyList);
            system("pause");
            exit(1);
        }*/
    }
        //判断少题的情况
        if(!feof(fpAnswer) && feof(fpStudent))
        {
            printf("\n出现错误！学生答案出现末尾少做题的状况，请重新检查并修改！\n");
            exit(1);
        }
        if(!feof(fpStudent) && feof(fpAnswer))
        {
            printf("\n出现错误！学生答案中出现比标准答案题数多的情况，请重新检查并修改！\n");
            exit(1);
        }

    rewind(fpStudent);
    rewind(fpAnswer);

    /*
    下面是没有漏题或者题号错误的情况下，对答案进行的校对
    */

    while(!feof(fpStudent) && !feof(fpAnswer))                //如果还没有到文件的结尾
    {
        if(fgets(string1,15,fpStudent)==NULL)
            printf("error in string1\n");     //把学生答案里的数据读出来存取进字符串string1，且每次读取一行
        //string2出现问题
		if(fgets(string2,15,fpAnswer)==NULL)
            printf("error in string2\n");      //把答案中第一行的数据读出来并存进字符串string2中
		p = string1;   //p指向string1
		q = string2;   //q指向string2
		while(*p!='.')
        {
            p++;    //将p指针指向.
        }
        while(*q!='.')
        {
            q++;    //将q指针指向.
        }
        p++;      //p指针指向第一位答案位
        q++;      //q指针指向第一个答案位
		while(*p!='\0')      //字符串string1都还没结束的时候比较数字位是否相等
		{
		    if(*p == *q)  //当前答案位正确，继续比较下一位
            {
                p++;
                q++;
            }
            else {    //p还没到字符串的末尾且p的字符与q的字符不相同（答案错误）
                break;    //发现答案错误，直接不用比较下面的位，跳出循环
            }
		}
		/*跳出循环的原因：
		1、任意一个字符串遍历结束，
		2、发现错误答案*/
		if(*p!='\0'||(*p=='\0' && *q!='\0'))    //错误答案有两种情况：1、某个位上的数字错误，2、数字的位数错误
        {
            p = string1;
            control1 = 0;
            //插入正确的链表
            while(*p!='.')
            {
                control1++;
                p++;
            }
           // printf("%d",control1);
            strncpy(temp,string1,control1);
            //将.之前的字符转换成字符串再变成int，赋给链表的结点
            InsertInList(wrongList,CreateAnswerNode(temp));       //将新结点插入错误链表中
            WrongNum++;
        }
        else if (*p == '\0' && *q == '\0')           //正确答案
        {
            p = string1;
            control2 = 0;
            //插入正确的链表
            while(*p!='.')
            {
                control2++;
                p++;
            }
            strncpy(temp1,string1,control2);
            InsertInList(correctList,CreateAnswerNode(temp1));
            CorrectNum++;
        }
    }

         //将正确题号和错误题号都输出：printf();
         printf("\nCorrect:%d",CorrectNum);
         visitAnswerList(correctList);
         printf("\nWrong:%d",WrongNum);
         visitAnswerList(wrongList);
         if(modifyList->next!=NULL)
         {
            printf("\n需要修改的题号为：");
            visitAnswerList(modifyList);
         }
         printf("\n");
         fclose(fpStudent);
         fclose(fpAnswer);
         fpStudent = NULL;
         fpAnswer = NULL;
         system("pause");
}



char* caozuofu(char* ziFu,int a)    //a为想要获得的操作符个数
{
    char *p;
    int shuZi[a];
	shuZi[a]= {0};
    for(int j=0; j<a; j++)
    {
        shuZi[j]=rand()%4;
        switch(shuZi[j])
        {
        case 0:
            ziFu[j]='+';
            break;
        case 1:
            ziFu[j]='-';
            break;
        case 2:
            ziFu[j]='*';
            break;
        case 3:
            ziFu[j]='/';
            break;
        default:
            ;
        }
    }
    return ziFu;
}

int gongyueshu(int x,int y)         //约分用的
{
    int i,p;
    if(x%y==0||y%x==0)
    {
        i=x<=y?x:y;
    }
    else      //x不能整除y或y不能整除x
    {
        if(x<y)
        {
            p=x;
            for(i=p; i>1; i--)
            {
                if(x%i==0&&y%i==0)
                    break;
            }
        }
        else     //x>y
        {
            p=y;
            for(i=p; i>1; i--)
            {
                if(x%i==0&&y%i==0)
                    break;
            }
        }
    }
    return i;
}




void  zhenfenshu(int x,int y,FILE *fp)    //将分数变成真分数
{

    int z,a,r;
    z=x/y;
    a=x%y;
    if(a==0)            //x整除y得时候即该数不为分数
    {
        fprintf(fp,"%d\n",z);
    }
    else              //x不整除y
    {
        if(z==0)      // x<y
        {
            fprintf(fp,"%d/%d\n",x/gongyueshu(x,y),y/gongyueshu(x,y));
        }
        else         //x>y
        {
            r=x-z*y;
            fprintf(fp,"%d'%d/%d\n",z,r/gongyueshu(r,y),y/gongyueshu(r,y));
        }
    }
}


//整数除法的函数
int* int_chuFa(int n1,int n2,int* num)
{
    int z1,a1,r1;
    z1=n1/n2;
    a1=n1%n2;
    if(a1==0)            //n1整除n2得时候即该数不为分数
    {
        num[0]=z1;
        num[1]=1;
    }
    else              //x不整除y
    {
        int yueshu = gongyueshu(n1,n2);
        num[0]=n1/yueshu;
        num[1]=n2/yueshu;
    }
    return num;
}
int main()
{
    time_t t;
    srand((unsigned) time(NULL));

    int r;
    printf("请问想要的操作是 1.生成四则运算题目\n");
    printf("                 2.对答案\n");
    printf("请输入你的选择: ");
    scanf("%d",&r);
    if(r==1)
    {
        int n1,n2,n3,n4,n5,n6,n7,n8;
        int a1,a2,a3,a4,a5,a6,a7,a8;
        char *string2;
        FILE *fp=fopen("题目.txt","w");
        FILE *answerfp=fopen("answer.txt","w");
        int i,count;
        int j;
        int number;
        printf("请输入题数  count = ");
        scanf("%d",&count);           //count道题目
        printf("请输入多少以内四则运算的题目  number = ");
        scanf("%d",&number);           //number以内的四则运算

        int a;
        printf("请输入想要题目的操作符个数  a = ");
        scanf("%d",&a);            //a个操作符
        char ziFu[a];
     	ziFu[a]	= {0};

        int* main_chufa;
        int chufa[2]= {0};

         //操作符的数组
        char op[20];
        char src[100];
        char src1[100];
        char src2[100];

        //操作数字符串数组
        char numbers[5][100];
//        char *h;
//        h=numbers;
//当想要整数四则运算的时候
        int x;
        printf("****************************\n");
        printf("如果想要整数四则运算请输入1\n");
        printf("如果想要包含分数四则运算请输入2\n");
        printf("请输入你的选择：");
        scanf("%d",&x);
//整数四则运算
        if(x==1)
        {
            for(i=1,j=1; i<=count,j<=count; i++,j++) /*j为题目的序号，i为答案的序号*/
            {
                string2 = caozuofu(ziFu,a);
                n1=rand()%number+1;n2=rand()%number+1;n3=rand()%number+1;n4=rand()%number+1;
                if(a==1)               //一个操作符
                {
                    fprintf(fp,"%d. ",j);//写题目
                    if(string2[0] == '-')
                    {
                        if(n1>=n2)
                        {
                            fprintf(fp,"%d  %c  %d = \n",n1,string2[0],n2);
						}
                       else
                        {
                           int temp;
                           temp=n1;n1=n2;n2=temp;
                           fprintf(fp,"%d  %c  %d = \n",n1,string2[0],n2);
                        }
                    }
                    else
                    {
                        fprintf(fp,"%d  %c  %d = \n",n1,string2[0],n2);
                    }
                    //整数时一个操作符的答案计算
                    fprintf(answerfp,"%d. ",i);
                    switch(string2[0])
                    {
                    case '+':
                    	{
                        fprintf(answerfp,"%d\n",n1+n2);
                        break;
                    }
                    case '-':
                    	{
                        if(n1<n2)
                        {
						fprintf(answerfp,"%d\n",n2-n1);
						}
                        else
                        {
                            fprintf(answerfp,"%d\n",n1-n2);
                        }
                        break;
                    }
                    case '*':
                    	{
                        fprintf(answerfp,"%d\n",n1*n2);
                        break;
                        }
                    case '/':
                    	{
                        zhenfenshu(n1,n2,answerfp);
                        break;
                        }
                    }//switch的大括号
                    op[0]=string2[0];
                    itoa(n1, src, 10);
                    strcpy(numbers[0],src);
                    itoa(n2, src, 10);
                    strcpy(numbers[1],src);
                }//if（a==1)的大括号
//整数计算--两个运算符时
                if(a==2)
                {
                    if(string2[0] == '+')  //第一个操作符为加法
                    {
                        switch(string2[1])  //判断第二个操作符
                        {
                        case '+'://n1+n2+n3
                        {
                            fprintf(fp,"%d. ",j);fprintf(fp,"%d  %c  %d  %c  %d = \n",n1,string2[0],n2,string2[1],n3);
                            fprintf(answerfp,"%d. ",i);fprintf(answerfp,"%d\n",n1+n2+n3);  //第二个操作符为‘+’即n1+n2+n3
                            break;
                        }
                        case '*':
                        {
                            fprintf(fp,"%d. ",j);fprintf(fp,"%d  %c  %d  %c  %d = \n",n1,string2[0],n2,string2[1],n3);
                            fprintf(answerfp,"%d. ",i);fprintf(answerfp,"%d\n",n1+n2*n3);   //第二个操作符为'*' 即n1+n2*n3
                            break;
                        }
                        case '/':  //第二个操作符为‘/’即n1+n2/n3(先算n2/n3)
                        {
                            fprintf(fp,"%d. ",j);fprintf(fp,"%d  %c  %d  %c  %d = \n",n1,string2[0],n2,string2[1],n3);
                            fprintf(answerfp,"%d. ",i);
                            main_chufa=int_chuFa(n2,n3,chufa);//
                            if(main_chufa[1] == 1)  //n2可以整除n3，结果在main_chufa[0]中
                            fprintf(answerfp,"%d \n",n1+main_chufa[0]);
                            else   //没有整除，进行完除法之后该值为分数，分子为main_chufa[0],分母在main_chufa[1]
                            {
                                int fenzi1=main_chufa[1]*n1+main_chufa[0];
                                zhenfenshu(fenzi1,main_chufa[1],answerfp);
                            }
                            break;
                        }
                        case '-'://n1+n2-n3
                        {
                            int n = n1+n2;
                            if(n<n3)
                            {
                                i--;j--;continue;
                            }
                            else
                            {
                                fprintf(fp,"%d. ",j);fprintf(fp,"%d  %c  %d  %c  %d = \n",n1,string2[0],n2,string2[1],n3);
                                fprintf(answerfp,"%d. ",i);fprintf(answerfp,"%d\n",n1+n2-n3);
                                break;
                            }
                        }
                        }
                    }
                    if(string2[0]=='-')
                    {
                        switch(string2[1])
                        {
                        case '+':
                        {
                            if(n1-n2<0)
                            {
                                i--;j--;continue;
                            }
                            else
                            {
                                fprintf(fp,"%d. ",j);fprintf(fp,"%d  %c  %d  %c  %d = \n",n1,string2[0],n2,string2[1],n3);
                                fprintf(answerfp,"%d. ",i);fprintf(answerfp,"%d\n",n1-n2+n3);
                            }
                            break;
                        }
                        case '*': //n1-n2*n3
                        {
                            int n=n2*n3;
                            if(n1<n)
                            {
                                i--;j--;continue;
                            }
                            else
                            {
                                fprintf(fp,"%d. ",j);fprintf(fp,"%d  %c  %d  %c  %d = \n",n1,string2[0],n2,string2[1],n3);
                                fprintf(answerfp,"%d. ",i);fprintf(answerfp,"%d\n",n1-n2*n3);
                            }
                            break;
                        }
                        case '/':
                        {
                            main_chufa=int_chuFa(n2,n3,chufa);
                            if(main_chufa[1] == 1)    //n2/n3为整数
                            {
                                if(n1<main_chufa[0])
                                {
                                    i--;j--; continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);fprintf(fp,"%d  %c  %d  %c  %d = \n",n1,string2[0],n2,string2[1],n3);
                                    fprintf(answerfp,"%d. ",i);fprintf(answerfp,"%d ",n1-main_chufa[0]);
                                }
                            }
                            else   //没有整除，进行完除法之后该值为分数
                            {
                                int fenzi1=main_chufa[1]*n1-main_chufa[0];
                                if(fenzi1<0)
                                {
                                    i--;j--;continue;
                                }
                                fprintf(fp,"%d. ",j);fprintf(fp,"%d  %c  %d  %c  %d = \n",n1,string2[0],n2,string2[1],n3);
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi1,main_chufa[1],answerfp);
                            }
                            break;
                        }
                        case '-'://n1-n2-n3
                        {
                            if(n1<n2)
                            {
                                i--;
                                j--;
                                continue;
                            }
                            else   //n1>=n2
                            {
                                if(n1-n2<n3)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d  %c  %d  %c  %d = \n",n1,string2[0],n2,string2[1],n3);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",n1-n2-n3);
                                }
                            }
                            break;
                        }
                        }
                    }
                    if(string2[0]=='*')  //第一个操作符是乘法
                    {
                        switch(string2[1])
                        {
                        case '+':
                        {
                            fprintf(fp,"%d. ",j);
                            fprintf(fp,"%d  %c  %d  %c  %d = \n",n1,string2[0],n2,string2[1],n3);
                            fprintf(answerfp,"%d. ",i);
                            fprintf(answerfp,"%d\n",n1*n2+n3);
                            break;
                        }
                        case '*':
                        {
                            fprintf(fp,"%d. ",j);
                            fprintf(fp,"%d  %c  %d  %c  %d = \n",n1,string2[0],n2,string2[1],n3);
                            fprintf(answerfp,"%d. ",i);
                            fprintf(answerfp,"%d\n",n1*n2*n3);
                            break;
                        }
                        case '/':  //n1*n2/n3
                        {
                            int jieguo1=n1*n2;
                            fprintf(fp,"%d. ",j);
                            fprintf(fp,"%d  %c  %d  %c  %d = \n",n1,string2[0],n2,string2[1],n3);
                            fprintf(answerfp,"%d. ",i);
                            zhenfenshu(jieguo1,n3,answerfp);
                            break;
                        }
                        case '-'://n1*n2-n3
                        {
                            int n = n1*n2;
                            if(n<n3)
                            {
                                i=i-1;
                                j--;
                                continue;
                            }
                            else
                            {
                                fprintf(fp,"%d. ",j);
                                fprintf(fp,"%d  %c  %d  %c  %d = \n",n1,string2[0],n2,string2[1],n3);
                                fprintf(answerfp,"%d. ",i);
                                fprintf(answerfp,"%d\n",n1*n2-n3);
                            }
                            break;
                        }
                        }
                    }
                    if(string2[0]=='/')   //第一个操作符是除法
                    {
                        main_chufa = int_chuFa(n1,n2,chufa);
                        switch(string2[1])
                        {
                        case '+': //n1/n2+n3
                        {
                            fprintf(fp,"%d. ",j);
                            fprintf(fp,"%d  %c  %d  %c  %d = \n",n1,string2[0],n2,string2[1],n3);
                            fprintf(answerfp,"%d. ",i);
                            if(main_chufa[1] == 1)//n1/n2为整数
                            {
                                fprintf(answerfp,"%d\n",main_chufa[0]+n3);
                            }
                            else//除法不为整数为分数
                            {
                                int fenzi = main_chufa[0]+n3*main_chufa[1];
                                zhenfenshu(fenzi,main_chufa[1],answerfp);
                            }
                            break;
                        }
                        case '*':
                        {
                            fprintf(fp,"%d. ",j);
                            fprintf(fp,"%d  %c  %d  %c  %d = \n",n1,string2[0],n2,string2[1],n3);
                            fprintf(answerfp,"%d. ",i);
                            if(main_chufa[1] == 1)//除法为整数
                            {
                                fprintf(answerfp,"%d\n",main_chufa[0]*n3);
                            }
                            else//除法为分数
                            {
                                int fenzi=main_chufa[1]*n3;
                                zhenfenshu(fenzi,main_chufa[1],answerfp);
                            }
                            break;
                        }
                        case '/':  //n1/n2/n3
                        {
                            fprintf(fp,"%d. ",j);
                            fprintf(fp,"%d  %c  %d  %c  %d = \n",n1,string2[0],n2,string2[1],n3);
                            fprintf(answerfp,"%d. ",i);
                            if(main_chufa[1] == 1)  //第一个除法的结果为整数
                                zhenfenshu(main_chufa[0],n3,answerfp);
                            else   //没有整除，进行完除法之后该值为分数
                            {
                                int fenmu=main_chufa[1]*n3;
                                zhenfenshu(main_chufa[0],fenmu,answerfp);
                            }
                            break;
                        }
                        case '-'://n1/n2-n3
                        {
                            int n3_fenzi=n3*main_chufa[1];
                            if(main_chufa[0]<n3_fenzi)
                            {
                                i--;
                                j--;
                                continue;
                            }
                            else
                            {
                                fprintf(fp,"%d. ",j);
                                fprintf(fp,"%d  %c  %d  %c  %d = \n",n1,string2[0],n2,string2[1],n3);
                                int fenzi=main_chufa[0]-n3_fenzi;
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,main_chufa[1],answerfp);
                            }
                            break;
                        }
                        } //switch
                    }//if string2=='/'
                    op[0]=string2[0];
                    itoa(n1, src, 10);
                    strcpy(numbers[0],src);
                    itoa(n2, src, 10);
                    strcpy(numbers[1],src);
                    op[1]=string2[1];
                    itoa(n3, src, 10);
                    strcpy(numbers[2],src);
                }//a==2
//整数计算---三个运算符时
                if(a==3)
                {
                    if(string2[0] == '+')
                    {
                        if(string2[1] == '+')
                        {
                            switch(string2[2])
                            {
                            case '+'://n1+n2+n3+n4
                            {
                                fprintf(fp,"%d. ",j);//写上题目
                                fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                fprintf(answerfp,"%d. ",i);
                                fprintf(answerfp,"%d\n",n1+n2+n3+n4);
                                break;
                            }
                            case '-'://n1+n2+n3-n4
                            {
                                int n=n1+n2+n3;
                                if(n<n4)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",n1+n2+n3-n4);
                                }
                                break;
                            }
                            case '*':  //n1+n2+n3*n4
                            {
                                fprintf(fp,"%d. ",j);
                                fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                fprintf(answerfp,"%d. ",i);
                                fprintf(answerfp,"%d\n",n1+n2+n3*n4);
                                break;
                            }
                            case '/' : //n1+n2+n3/n4
                            {
                                fprintf(fp,"%d. ",j);
                                fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                main_chufa=int_chuFa(n3,n4,chufa);
                                if(main_chufa[1]==1)//即n3/n4为整数
                                {
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",n1+n2+main_chufa[0]);
                                }
                                else//n3/n4不为整数
                                {
                                    int n=n1+n2;
                                    int fenzi=n*main_chufa[1]+main_chufa[0];
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,main_chufa[1],answerfp);
                                }
                                break;
                            }
                            }
                        }
                        if(string2[1]=='-')//n1+n2-n3
                        {
                            switch(string2[2])
                            {
                            case '+'://n1+n2-n3+n4
                            {
                                int n=n1+n2;
                                if(n<n3)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",n1+n2-n3+n4);
                                }
                                break;
                            }
                            case '-':  //n1+n2-n3-n4
                            {
                                int n=n1+n2;
                                if(n<n3)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int jieguo=n1+n2-n3;
                                    if(jieguo<n4)
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        fprintf(answerfp,"%d\n",n1+n2-n3-n4);
                                    }
                                }
                                break;
                            }
                            case '*'://n1+n2-n3*n4
                            {
                                int jieguo = n3*n4;
                                if(n1+n2<jieguo)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",n1+n2-n3*n4);
                                }
                                break;
                            }
                            case '/'://n1+n2-n3/n4
                            {
                                int n=n1+n2;
                                main_chufa=int_chuFa(n3,n4,chufa);
                                int fenzi=n*main_chufa[1]-main_chufa[0];
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,main_chufa[1],answerfp);
                                }
                                break;
                            }
                            }
                        }//if(string2[1]=='-')
                        if(string2[1]=='*') //n1+n2*n3
                        {
                            switch(string2[2])
                            {
                            case '+'://n1+n2*n3+n4;
                            {
                                fprintf(fp,"%d. ",j);
                                fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                fprintf(answerfp,"%d. ",i);
                                fprintf(answerfp,"%d\n",n1+n2*n3+n4);
                                break;
                            }
                            case '-'://n1+n2*n3-n4
                            {
                                int n=n1+n2*n3;
                                if(n<n4)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",n1+n2*n3-n4);
                                }
                                break;
                            }
                            case '*'://n1+n2*n3*n4
                            {
                                fprintf(fp,"%d. ",j);
                                fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                fprintf(answerfp,"%d. ",i);
                                fprintf(answerfp,"%d\n",n1+n2*n3*n4);
                                break;
                            }
                            case '/'://n1+n2*n3/n4
                            {
                                int n=n2*n3;
                                main_chufa=int_chuFa(n,n4,chufa);
                                int fenzi=n1*main_chufa[1]+main_chufa[0];
                                fprintf(fp,"%d. ",j);
                                fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,main_chufa[1],answerfp);
                                break;
                            }
                            }//switch
                        }//if(string2[1]=='*'
                        if(string2[1]=='/')//n1+n2/n3
                        {
                            int fenzi2;
                            main_chufa=int_chuFa(n2,n3,chufa);
                            if(main_chufa[1]==1)//n2/n3为整数
                            {
                                int n=n1+main_chufa[0];
                            }
                            else
                            {
                                int fenzi=n1*main_chufa[1]+main_chufa[0];
                            }
                            switch(string2[2])
                            {
                            case '+'://n1+n2/n3+n4
                            {
                                main_chufa=int_chuFa(n2,n3,chufa);
                                int fenzi2=n1*main_chufa[1]+main_chufa[0]+n4*main_chufa[1];
                                fprintf(fp,"%d. ",j);
                                fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                fprintf(answerfp,"%d. ",i);
                                if(main_chufa[1]==1)
                                {
                                    fprintf(answerfp,"%d\n",n1+main_chufa[0]+n4);
                                }
                                else
                                {
                                    zhenfenshu(fenzi2,main_chufa[1],answerfp);
                                }
                                break;
                            }
                            case '-'://n1+n2/n3-n4
                            {
                                main_chufa=int_chuFa(n2,n3,chufa);
                                if(main_chufa[1]==1)
                                {
                                    int n=n1+main_chufa[0];
                                    if(n<n4)
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        fprintf(answerfp,"%d\n",n-n4);
                                    }
                                }
                                else//n2/n3不为整数
                                {
                                    int fenzi2=n1*main_chufa[1]+main_chufa[0]-n4*main_chufa[1];
                                    if(fenzi2<0)
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else //fenzi2>=0
                                    {
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        zhenfenshu(fenzi2,main_chufa[1],answerfp);
                                    }
                                }
                                break;
                            }
                            case '*'://n1+n2/n3*n4
                            {
                                main_chufa=int_chuFa(n2*n4,n3,chufa);
                                fprintf(fp,"%d. ",j);
                                fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                fprintf(answerfp,"%d. ",i);
                                if(main_chufa[1]==1)
                                {
                                    fprintf(answerfp,"%d\n",n1+main_chufa[0]);
                                }
                                else
                                {
                                    int fenzi2=n1*main_chufa[1]+main_chufa[0];
                                    zhenfenshu(fenzi2,main_chufa[1],answerfp);
                                }
                                break;
                            }
                            case '/'://n1+n2/n3/n4;
                            {
                                main_chufa=int_chuFa(n2,n3*n4,chufa);
                                if(main_chufa[1]==1)
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",n1+main_chufa[0]);
                                }
                                else //n2/(n3*n4)不为整数
                                {
                                    fenzi2=n1*main_chufa[1]+main_chufa[0];
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi2,main_chufa[1],answerfp);
                                }
                                break;
                            }
                            }//switch
                        }//if(string2[1]=='/')
                    }//string2[0]=='+'
                    if(string2[0]=='-')//n1-n2
                    {
                        int p=0;
                        if(n1<n2)
                            p=1;//p=1的时候出现负数
                        if(string2[1]=='+')//n1-n2+n3
                        {
                            switch(string2[2])
                            {
                            case '+'://n1-n2+n3+n4
                            {
                                if(n1<n2)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",n1-n2+n3+n4);
                                }
                                break;
                            }
                            case '-'://n1-n2+n3-n4
                            {
                                if(n1<n2)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    if(n1-n2+n3<n4)
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        fprintf(answerfp,"%d\n",n1-n2+n3-n4);
                                    }
                                }
                                break;
                            }
                            case '*'://n1-n2+n3*n4
                            {
                                if(n1<n2)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",n1-n2+n3*n4);
                                }
                                break;
                            }
                            case '/'://n1-n2+n3/n4
                            {
                                if(n1<n2)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    main_chufa=int_chuFa(n3,n4,chufa);
                                    if(main_chufa[1]==1)
                                    {
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        fprintf(answerfp,"%d\n",n1-n2+main_chufa[0]);
                                    }
                                    else
                                    {
                                        int fenzi=(n1-n2)*main_chufa[1]+main_chufa[0];
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        zhenfenshu(fenzi,main_chufa[1],answerfp);
                                    }
                                }
                                break;
                            }
                            }//switch
                        }//if(string2[1]=='+'
                        if(string2[1]=='-')//n1-n2-n3
                        {
                            switch(string2[2])
                            {
                            case '+'://n1-n2-n3+n4
                            {
                                if(p==1)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    if(n1-n2<n3)
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        fprintf(answerfp,"%d\n",n1-n2-n3+n4);
                                    }
                                }
                                break;
                            }
                            case '-'://n1-n2-n3-n4
                            {
                                if(p==1)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    if(n1-n2<n3)
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else
                                    {
                                        if(n1-n2-n3<n4)
                                        {
                                            i--;
                                            j--;
                                            continue;
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d. ",j);
                                            fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                            fprintf(answerfp,"%d. ",i);
                                            fprintf(answerfp,"%d\n",n1-n2-n3-n4);
                                        }
                                    }
                                }
                                break;
                            }
                            case '*'://n1-n2-n3*n4
                            {
                                if(p==1)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    if(n1-n2<n3*n4)
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        fprintf(answerfp,"%d\n",n1-n2-n3*n4);
                                    }
                                }
                                break;
                            }
                            case '/'://n1-n2-n3/n4
                            {
                                if(p==1)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    main_chufa=int_chuFa(n3,n4,chufa);
                                    if(main_chufa[1]==1)
                                    {
                                        if(n1-n2<main_chufa[0])
                                        {
                                            i--;
                                            j--;
                                            continue;
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d. ",j);
                                            fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                            fprintf(answerfp,"%d. ",i);
                                            fprintf(answerfp,"%d\n",n1-n2-main_chufa[0]);
                                        }
                                    }
                                    else //n3/n4不为整数
                                    {
                                        if((n1-n2)*main_chufa[1]<main_chufa[0])
                                        {
                                            i--;
                                            j--;
                                            continue;
                                        }
                                        else
                                        {
                                            int fenzi=(n1-n2)*main_chufa[1]-main_chufa[0];
                                            fprintf(fp,"%d. ",j);
                                            fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                            fprintf(answerfp,"%d. ",i);
                                            zhenfenshu(fenzi,main_chufa[1],answerfp);
                                        }
                                    }
                                }
                                break;
                            }
                            }//switch
                        }//if(string[1]=='-')
                        if(string2[1]=='*')//n1-n2*n3
                        {
                            switch(string2[2])
                            {
                            case '+'://n1-n2*n3+n4
                            {
                                if(n1<n2*n3)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",n1-n2*n3+n4);
                                }
                                break;
                            }
                            case '-'://n1-n2*n3-n4
                            {
                                if(n1<(n2*n3))
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    if(n1-n2*n3<n4)
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        fprintf(answerfp,"%d\n",n1-n2*n3-n4);
                                    }
                                }
                                break;
                            }
                            case '*'://n1-n2*n3*n4
                            {
                                if(n1<n2*n3*n4)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",n1-n2*n3*n4);
                                }
                                break;
                            }
                            case '/'://n1-n2*n3/n4
                            {
                                main_chufa=int_chuFa(n2*n3,n4,chufa);
                                if(main_chufa[1]==1)
                                {
                                    if(n1<main_chufa[0])
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        fprintf(answerfp,"%d\n",n1-main_chufa[0]);
                                    }
                                }
                                else //n2*n3/n4不为整数
                                {
                                    int fenzi=n1*main_chufa[1]-main_chufa[0];
                                    if(fenzi<0)
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        zhenfenshu(fenzi,main_chufa[1],answerfp);
                                    }
                                }
                                break;
                            }
                            }//switch
                        }//if(string2[1])
                        if(string2[1]=='/')//n1-n2/n3
                        {
                            switch(string2[2])
                            {
                            case '+'://n1-n2/n3+n4;
                            {
                                main_chufa=int_chuFa(n2,n3,chufa);
                                if(n1*main_chufa[1]-main_chufa[0]<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    if(main_chufa[1]==1)
                                    {
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        fprintf(answerfp,"%d\n",n1-main_chufa[0]+n4);
                                    }
                                    else
                                    {
                                        int fenzi=n1*main_chufa[1]-main_chufa[0]+main_chufa[1]*n4;
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        zhenfenshu(fenzi,main_chufa[1],answerfp);
                                    }
                                }
                                break;
                            }
                            case '-'://n1-n2/n3-n4
                            {
                                main_chufa=int_chuFa(n2,n3,chufa);
                                if(n1*main_chufa[1]-main_chufa[0]<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    if(n1*main_chufa[1]-main_chufa[0]<n4*main_chufa[1])
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else
                                    {
                                        if(main_chufa[1]==1)
                                        {
                                            fprintf(fp,"%d. ",j);
                                            fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                            fprintf(answerfp,"%d. ",i);
                                            fprintf(answerfp,"%d\n",n1-main_chufa[0]-n4);
                                        }
                                        else
                                        {
                                            int fenzi=n1*main_chufa[1]-main_chufa[0]-main_chufa[1]*n4;
                                            fprintf(fp,"%d. ",j);
                                            fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                            fprintf(answerfp,"%d. ",i);
                                            zhenfenshu(fenzi,main_chufa[1],answerfp);
                                        }
                                    }
                                }
                                break;
                            }
                            case '*'://n1-n2/n3*n4
                            {
                                main_chufa=int_chuFa(n2*n4,n3,chufa);
                                if(n1*main_chufa[1]<main_chufa[0])
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenzi=n1*main_chufa[1]-main_chufa[0];
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,main_chufa[1],answerfp);
                                }
                                break;
                            }
                            case '/'://n1-n2/n3/n4
                            {
                                main_chufa=int_chuFa(n2,n3*n4,chufa);
                                if(n1*main_chufa[1]<main_chufa[0])
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenzi=n1*main_chufa[1]-main_chufa[0];
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,main_chufa[1],answerfp);
                                }
                                break;
                            }
                            }//switch

                        }//if(string2[1])
                    }//if(string2[0]=='-')
                    if(string2[0]=='*')//n1*n2
                    {
                        if(string2[1]=='+')//n1*n2+n3
                        {
                            switch(string2[2])
                            {
                            case '+'://n1*n2+n3+n4
                            {
                                fprintf(fp,"%d. ",j);
                                fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                fprintf(answerfp,"%d. ",i);
                                fprintf(answerfp,"%d\n",n1*n2+n3+n4);
                                break;
                            }
                            case '-'://n1*n2+n3-n4
                            {
                                if(n1*n2+n3<n4)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",n1*n2+n3-n4);
                                }
                                break;
                            }
                            case '*'://n1*n2+n3*n4
                            {
                                fprintf(fp,"%d. ",j);
                                fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                fprintf(answerfp,"%d. ",i);
                                fprintf(answerfp,"%d\n",n1*n2+n3*n4);
                                break;
                            }
                            case '/'://n1*n2+n3/n4;
                            {
                                main_chufa=int_chuFa(n3,n4,chufa);
                                if(main_chufa[1]==1)
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",n1*n2+main_chufa[0]);
                                }
                                else
                                {
                                    int fenzi=n1*n2*main_chufa[1]+main_chufa[0];
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,main_chufa[1],answerfp);
                                }
                                break;
                            }

                            }//switch
                        }//if(string2[1]='+'
                        if(string2[1]=='-')//n1*n2-n3
                        {
                            switch(string2[2])
                            {
                            case '+'://n1*n2-n3+n4
                            {
                                if(n1*n2<n3)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",n1*n2-n3+n4);
                                }
                                break;
                            }
                            case '-'://n1*n2-n3-n4
                            {
                                if(n1*n2<n3)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    if(n1*n2-n3<n4)
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        fprintf(answerfp,"%d\n",n1*n2-n3-n4);
                                    }
                                }
                                break;
                            }
                            case '*'://n1*n2-n3*n4
                            {
                                if(n1*n2<n3*n4)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",n1*n2-n3*n4);
                                }
                                break;
                            }
                            case '/'://n1*n2-n3/n4
                            {
                                main_chufa=int_chuFa(n3,n4,chufa);
                                if(main_chufa[1]==1)
                                {
                                    if(n1*n2<main_chufa[0])
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        fprintf(answerfp,"%d\n",n1*n2-main_chufa[0]);
                                    }
                                }
                                else
                                {
                                    int fenzi=n1*n2*main_chufa[1]-main_chufa[0];
                                    if(fenzi<0)
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        zhenfenshu(fenzi,main_chufa[1],answerfp);
                                    }
                                }
                                break;
                            }
                            }//switch
                        }//string[1]=='-
                        if(string2[1] == '*')//n1*n2*n3
                        {
                            switch(string2[2])
                            {
                            case'+'://n1*n2*n3+n4
                            {
                                fprintf(fp,"%d. ",j);
                                fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                fprintf(answerfp,"%d. ",i);
                                fprintf(answerfp,"%d\n",n1*n2*n3+n4);
                                break;
                            }
                            case '-'://n1*n2*n3-n4;
                            {
                                if(n1*n2*n3<n4)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",n1*n2*n3-n4);
                                }
                                break;
                            }
                            case '*'://n1*n2*n3*n4
                            {
                                fprintf(fp,"%d. ",j);
                                fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                fprintf(answerfp,"%d. ",i);
                                fprintf(answerfp,"%d\n",n1*n2*n3*n4);
                                break;
                            }
                            case'/'://n1*n2*n3/n4
                            {
                                main_chufa=int_chuFa(n1*n2*n3,n4,chufa);
                                if(main_chufa[1]==1)
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",main_chufa[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(main_chufa[0],main_chufa[1],answerfp);
                                }
                                break;
                            }
                            }//switch
                        }//string1
                        if(string2[1]=='/')//n1*n2/n3
                        {
                            switch(string2[2])
                            {
                            case '+'://n1*n2/n3+n4
                            {
                                main_chufa=int_chuFa(n1*n2,n3,chufa);
                                if(main_chufa[1]==1)
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",main_chufa[0]+n4);
                                }
                                else
                                {
                                    int fenzi=main_chufa[0]+n4*main_chufa[1];
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,main_chufa[1],answerfp);
                                }
                                break;
                            }
                            case '-'://n1*n2/n3-n4;
                            {
                                main_chufa=int_chuFa(n1*n2,n3,chufa);
                                if(main_chufa[0]<n4*main_chufa[1])
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    if(main_chufa[1]==1)
                                    {
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        fprintf(answerfp,"%d\n",main_chufa[0]-n4);
                                    }
                                    else
                                    {
                                        int fenzi=main_chufa[0]-n4*main_chufa[1];
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        zhenfenshu(fenzi,main_chufa[1],answerfp);
                                    }
                                }
                                break;
                            }
                            case '*'://n1*n2/n3*n4
                            {
                                main_chufa=int_chuFa(n1*n2*n4,n3,chufa);
                                if(main_chufa[1]==1)
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",main_chufa[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(main_chufa[0],main_chufa[1],answerfp);
                                }
                                break;
                            }
                            case '/'://n1*n2/n3/n4
                            {
                                main_chufa=int_chuFa(n1*n2,n3*n4,chufa);
                                if(main_chufa[1]==1)
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",main_chufa[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(main_chufa[0],main_chufa[1],answerfp);
                                }
                                break;
                            }
                            }//switch
                        }//string2[1]=='/'
                    }//string2[0]==*
                    if(string2[0]=='/')//n1/n2
                    {
                        if(string2[1]=='+')//n1/n2+n3
                        {
                            switch(string2[2])
                            {
                            case '+'://n1/n2+n3+n4
                            {
                                main_chufa=int_chuFa(n1,n2,chufa);
                                if(main_chufa[1]==1)
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",main_chufa[0]+n3+n4);
                                }
                                else
                                {
                                    int fenzi=main_chufa[0]+(n3+n4)*main_chufa[1];
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,main_chufa[1],answerfp);
                                }
                                break;
                            }
                            case '-'://n1/n2+n3-n4;
                            {
                                main_chufa=int_chuFa(n1,n2,chufa);
                                if(main_chufa[0]+main_chufa[1]*n3<main_chufa[1]*n4)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    if(main_chufa[1]==1)
                                    {
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        fprintf(answerfp,"%d\n",main_chufa[0]+n3-n4);
                                    }
                                    else
                                    {
                                        int fenzi=main_chufa[0]+main_chufa[1]*n3-main_chufa[1]*n4;
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        zhenfenshu(fenzi,main_chufa[1],answerfp);
                                    }
                                }
                                break;
                            }
                            case '*'://n1/n2+n3*n4
                            {
                                main_chufa=int_chuFa(n1,n2,chufa);
                                if(main_chufa[1]==1)
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",main_chufa[0]+n3*n4);
                                }
                                else
                                {
                                    int fenzi=main_chufa[0]+n3*n4*main_chufa[1];
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,main_chufa[1],answerfp);
                                }
                                break;
                            }
                            case '/'://n1/n2+n3/n4
                            {
                                main_chufa=int_chuFa(n1,n2,chufa);
                                int q1=main_chufa[0];
                                int q2=main_chufa[1];
                                main_chufa=int_chuFa(n3,n4,chufa);
                                if(q2==1)
                                {
                                    if(main_chufa[1]==1)
                                    {
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        fprintf(answerfp,"%d\n",main_chufa[0]+q1);
                                    }
                                    else//q1+[0]/[1]
                                    {
                                        int fenzi1=q1*main_chufa[1]+main_chufa[0];
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        zhenfenshu(fenzi1,main_chufa[1],answerfp);
                                    }
                                }
                                else//q2!=1
                                {
                                    if(main_chufa[1]==1)//q1/q2+[0]
                                    {
                                        int fenzi2=q1+main_chufa[0]*q2;
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        zhenfenshu(fenzi2,q2,answerfp);
                                    }
                                    else
                                    {
                                        //q1/q2+main_[0]/main_[1];
                                        int fenzi3=q1*main_chufa[1]+main_chufa[0]*q2;
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        zhenfenshu(fenzi3,main_chufa[1]*q2,answerfp);
                                    }
                                }
                                break;
                            }
                            }//switch
                        }
                        if(string2[1]=='-')//n1/n2-n3
                        {
                            main_chufa=int_chuFa(n1,n2,chufa);
                            switch(string2[2])
                            {
                            case '+'://n1/n2-n3+n4
                            {
                                if(main_chufa[0]<main_chufa[1]*n3)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    if(main_chufa[1]==1)
                                    {
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        fprintf(answerfp,"%d\n",main_chufa[0]-n3+n4);
                                    }
                                    else
                                    {
                                        int fenzi=main_chufa[0]-n3*main_chufa[1]+n4*main_chufa[1];
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        zhenfenshu(fenzi,main_chufa[1],answerfp);
                                    }
                                }
                                break;
                            }
                            case '-'://n1/n2-n3-n4
                            {
                                if(main_chufa[0]<main_chufa[1]*n3)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenzi2=main_chufa[0]-n3*main_chufa[1]-main_chufa[1]*n4;
                                    if(fenzi2<0)
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else
                                    {
                                        if(main_chufa[1]==1)
                                        {
                                            fprintf(fp,"%d. ",j);
                                            fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                            fprintf(answerfp,"%d. ",i);
                                            fprintf(answerfp,"%d\n",main_chufa[0]-n3-n4);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d. ",j);
                                            fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                            fprintf(answerfp,"%d. ",i);
                                            zhenfenshu(fenzi2,main_chufa[1],answerfp);
                                        }
                                    }
                                }
                                break;
                            }
                            case '*'://n1/n2-n3*n4
                            {
                                if(main_chufa[0]<n3*n4*main_chufa[1])
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    if(main_chufa[1]==1)
                                    {
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        fprintf(answerfp,"%d\n",main_chufa[0]-n3*n4);
                                    }
                                    else
                                    {
                                        int fenzi=main_chufa[0]+n3*n4*main_chufa[1];
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        zhenfenshu(fenzi,main_chufa[1],answerfp);
                                    }
                                }
                                break;
                            }
                            case '/'://n1/n2-n3/n4
                            {
                                main_chufa=int_chuFa(n1,n2,chufa);
                                int q1=main_chufa[0];
                                int q2=main_chufa[1];
                                main_chufa=int_chuFa(n3,n4,chufa);
                                if(q1*main_chufa[1]<main_chufa[0]*q2)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    if(q2==1)
                                    {
                                        if(main_chufa[1]==1)
                                        {
                                            fprintf(fp,"%d. ",j);
                                            fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                            fprintf(answerfp,"%d. ",i);
                                            fprintf(answerfp,"%d\n",q1-main_chufa[0]);
                                        }
                                        else
                                        {
                                            int fenzi1=q1*main_chufa[1]-main_chufa[0];
                                            fprintf(fp,"%d. ",j);
                                            fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                            fprintf(answerfp,"%d. ",i);
                                            zhenfenshu(fenzi1,main_chufa[1],answerfp);
                                        }
                                    }
                                    else
                                    {
                                        if(main_chufa[1]==1)
                                        {
                                            int fenzi2=q1-main_chufa[0]*q2;
                                            fprintf(fp,"%d. ",j);
                                            fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                            fprintf(answerfp,"%d. ",i);
                                            zhenfenshu(fenzi2,q2,answerfp);
                                        }
                                        else
                                        {
                                            //q1/q2+main_[0]/main_[1];
                                            int fenzi3=q1*main_chufa[1]-main_chufa[0]*q2;
                                            fprintf(fp,"%d. ",j);
                                            fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                            fprintf(answerfp,"%d. ",i);
                                            zhenfenshu(fenzi3,main_chufa[1]*q2,answerfp);
                                        }
                                    }
                                }
                                break;
                            }
                            }//switch
                        }
                        if(string2[1]=='*')//n1/n2*n3
                        {
                            switch(string2[2])
                            {
                            case '+'://n1/n2*n3+n4
                            {
                                main_chufa=int_chuFa(n1*n3,n2,chufa);
                                if(main_chufa[1]==1)
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",main_chufa[0]+n4);
                                }
                                else
                                {
                                    int fenzi=main_chufa[0]+n4*main_chufa[1];
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,main_chufa[1],answerfp);
                                }
                                break;
                            }
                            case '-'://n1/n2*n3-n4
                            {
                                main_chufa=int_chuFa(n1*n3,n2,chufa);
                                if(main_chufa[0]<n4*main_chufa[1])
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    if(main_chufa[1]==1)
                                    {
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        fprintf(answerfp,"%d\n",main_chufa[0]-n4);
                                    }
                                    else
                                    {
                                        int fenzi=main_chufa[0]-n4*main_chufa[1];
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        zhenfenshu(fenzi,main_chufa[1],answerfp);
                                    }
                                }
                                break;
                            }
                            case '*'://n1/n2*n3*n4
                            {
                                main_chufa=int_chuFa(n1*n3*n4,n2,chufa);
                                if(main_chufa[1]==1)
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",main_chufa[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(main_chufa[0],main_chufa[1],answerfp);
                                }
                                break;
                            }
                            case '/'://n1/n2*n3/n4
                            {
                                main_chufa=int_chuFa(n1*n3,n2*n4,chufa);
                                if(main_chufa[1]==1)
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",main_chufa[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(main_chufa[0],main_chufa[1],answerfp);
                                }
                                break;
                            }
                            }//switch
                        }
                        if(string2[1]=='/')//n1/n2/n3
                        {
                            switch(string2[2])
                            {
                            case '+'://n1/n2/n3+n4
                            {
                                main_chufa=int_chuFa(n1,n2*n3,chufa);
                                if(main_chufa[1]==1)
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",main_chufa[0]+n4);
                                }
                                else
                                {
                                    int fenzi=main_chufa[0]+n4*main_chufa[1];
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,main_chufa[1],answerfp);
                                }
                                break;
                            }
                            case '-'://n1/n2/n3-n4
                            {
                                main_chufa=int_chuFa(n1,n2*n3,chufa);
                                if(main_chufa[0]<n4*main_chufa[1])
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    if(main_chufa[1]==1)
                                    {
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        fprintf(answerfp,"%d\n",main_chufa[0]-n4);
                                    }
                                    else
                                    {
                                        int fenzi=main_chufa[0]-n4*main_chufa[1];
                                        fprintf(fp,"%d. ",j);
                                        fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                        fprintf(answerfp,"%d. ",i);
                                        zhenfenshu(fenzi,main_chufa[1],answerfp);
                                    }
                                }
                                break;
                            }
                            case '*'://n1/n2/n3*n4
                            {
                                main_chufa=int_chuFa(n1*n4,n2*n3,chufa);
                                if(main_chufa[1]==1)
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",main_chufa[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(main_chufa[0],main_chufa[1],answerfp);
                                }
                                break;
                            }
                            case '/'://n1/n2/n3/n4
                            {
                                main_chufa=int_chuFa(n1,n2*n3*n4,chufa);
                                if(main_chufa[1]==1)
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    fprintf(answerfp,"%d\n",main_chufa[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    fprintf(fp,"%d %c %d %c %d %c %d = \n",n1,string2[0],n2,string2[1],n3,string2[2],n4);
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(main_chufa[0],main_chufa[1],answerfp);
                                }
                                break;
                            }
                            }//switch
                        }//if(string2[1]=='/'
                    }//if(string2[0]=='/')
                    itoa(n1, src, 10);
                    strcpy(numbers[0],src);
                    op[0]=string2[0];
                    itoa(n2, src, 10);
                    strcpy(numbers[1],src);
                    op[1]=string2[1];
                    itoa(n3, src, 10);
                    strcpy(numbers[2],src);
                    op[2]=string2[2];
                    itoa(n4, src, 10);
                    strcpy(numbers[3],src);
                }//a==3
            }//for
        }//x==1
        //分数四则运算的计算
        if(x==2)
        {
            int num[2]= {0};
            int* main_floatchu;
            for(j = 1,i = 1; i <= count,j<=count; i++,j++)
            {
                string2 = caozuofu(ziFu,a);
                n1 = rand()%number+1;
                n2 = rand()%number+1;
                n3 = rand()%number+1;
                n4 = rand()%number+1;
                n5 = rand()%number+1;
                n6 = rand()%number+1;
                n7 = rand()%number+1;
                n8 = rand()%number+1;
                if(a == 1)               //一个操作符string2[0]
                {
                    switch(string2[0])
                    {
                    case '+'://n1/n2 +n3/n4
                    {
                        int fenzi=n1*n4+n3*n2;
                        int fenmu=n2*n4;
                        fprintf(fp,"%d. ",j);
                        main_floatchu=int_chuFa(n1,n2,num);
                        if(num[1]==1)
                        {
                            fprintf(fp,"%d",num[0]);
                        }
                        else
                        {
                            fprintf(fp,"%d/%d",num[0],num[1]);
                        }
                        fprintf(fp," %c ",string2[0]);
                        main_floatchu=int_chuFa(n3,n4,num);
                        if(num[1]==1)
                        {
                            fprintf(fp,"%d",num[0]);
                        }
                        else
                        {
                            fprintf(fp,"%d/%d",num[0],num[1]);
                        }
                        fprintf(fp," = \n");
                        fprintf(answerfp,"%d.",i);
                        zhenfenshu(fenzi,fenmu,answerfp);
                        break;
                    }
                    case '-'://n1/n2-n3/n4
                    {
                        int fenzi=n1*n4-n3*n2;
                        int fenmu=n2*n4;
                        if(fenzi<0)
                        {
                            i--;
                            j--;
                            continue;
                        }
                        else
                        {
                            fprintf(fp,"%d. ",j);
                            main_floatchu=int_chuFa(n1,n2,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," %c ",string2[0]);
                            main_floatchu=int_chuFa(n3,n4,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," = \n");
                            fprintf(answerfp,"%d.",i);
                            zhenfenshu(fenzi,fenmu,answerfp);
                        }
                        break;
                    }
                    case '*'://n1/n2*n3/n4
                    {
                        int fenzi=n1*n3;
                        int fenmu=n2*n4;
                        fprintf(fp,"%d. ",j);
                        main_floatchu=int_chuFa(n1,n2,num);
                        if(num[1]==1)
                        {
                            fprintf(fp,"%d",num[0]);
                        }
                        else
                        {
                            fprintf(fp,"%d/%d",num[0],num[1]);
                        }
                        fprintf(fp," %c ",string2[0]);
                        main_floatchu=int_chuFa(n3,n4,num);
                        if(num[1]==1)
                        {
                            fprintf(fp,"%d",num[0]);
                        }
                        else
                        {
                            fprintf(fp,"%d/%d",num[0],num[1]);
                        }
                        fprintf(fp," = \n");
                        fprintf(answerfp,"%d.",i);
                        zhenfenshu(fenzi,fenmu,answerfp);
                        break;
                    }
                    case '/'://n1/n2/n3/n4
                    {
                        int fenmu=n2*n3*n4;
                        fprintf(fp,"%d. ",j);
                        main_floatchu=int_chuFa(n1,n2,num);
                        if(num[1]==1)
                        {
                            fprintf(fp,"%d",num[0]);
                        }
                        else
                        {
                            fprintf(fp,"%d/%d",num[0],num[1]);
                        }
                        fprintf(fp," %c ",string2[0]);
                        main_floatchu=int_chuFa(n3,n4,num);
                        if(num[1]==1)
                        {
                            fprintf(fp,"%d",num[0]);
                        }
                        else
                        {
                            fprintf(fp,"%d/%d",num[0],num[1]);
                        }
                        fprintf(fp," = \n");
                        fprintf(answerfp,"%d.",i);
                        zhenfenshu(n1,fenmu,answerfp);
                        break;
                    }
                    }//switch  op[0]=string2[0];
                    main_floatchu=int_chuFa(n1,n2,num);
                    itoa(num[0],src1,10);
                    itoa(num[1],src2,10);
                    strcat(src1,"/");
					strcat(src1,src2);
					strcpy(numbers[0],src1);
					op[0]=string2[0]; 
					main_floatchu=int_chuFa(n3,n4,num);
					itoa(num[0],src1,10);
                    itoa(num[1],src2,10);
                    strcat(src1,"/");
					strcat(src1,src2);
					strcpy(numbers[1],src1);
                }//a==1

                if(a == 2)               //两个操作符三个操作数
                {
                    if(string2[0]=='+')
                    {
                        switch(string2[1])
                        {
                        case '+'://n1/n2+n3/n4+n5/n6
                        {
                            int fenzi=n1*n4*n6+n3*n2*n6+n5*n2*n4;
                            int fenmu= n2*n4*n6;
                            fprintf(fp,"%d. ",j);
                            main_floatchu=int_chuFa(n1,n2,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," %c ",string2[0]);
                            main_floatchu=int_chuFa(n3,n4,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," %c ",string2[1]);
                            main_floatchu=int_chuFa(n5,n6,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," = \n");
                            fprintf(answerfp,"%d. ",i);
                            zhenfenshu(fenzi,fenmu,answerfp);
                            break;
                        }
                        case '-'://n1/n2 + n3/n4 - n5/n6;
                        {
                            int fenzi=n1*n4*n6+n3*n3*n6-n5*n2*n4;
                            int fenmu=n2*n4*n6;
                            if(fenzi<0)
                            {
                                i--;
                                j--;
                                continue;
                            }
                            else
                            {
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                            }
                            break;
                        }
                        case '*'://n1/n2 + n3/n4 * n5/n6
                        {
                            int fenzi=n1*n4*n6+n3*n5*n2;
                            int fenmu=n2*n4*n6;
                            fprintf(fp,"%d. ",j);
                            main_floatchu=int_chuFa(n1,n2,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," %c ",string2[0]);
                            main_floatchu=int_chuFa(n3,n4,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," %c ",string2[1]);
                            main_floatchu=int_chuFa(n5,n6,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," = \n");
                            fprintf(answerfp,"%d. ",i);
                            zhenfenshu(fenzi,fenmu,answerfp);
                            break;
                        }
                        case '/'://n1/n2 +n3/n4 /n5/n6;
                        {
                            int fenzi=n1*n4*n5+n3*n2*n6;
                            int fenmu=n2*n4*n5;
                            fprintf(fp,"%d. ",j);
                            main_floatchu=int_chuFa(n1,n2,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," %c ",string2[0]);
                            main_floatchu=int_chuFa(n3,n4,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," %c ",string2[1]);
                            main_floatchu=int_chuFa(n5,n6,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," = \n");
                            fprintf(answerfp,"%d. ",i);
                            zhenfenshu(fenzi,fenmu,answerfp);
                            break;
                        }
                        }//switch
                    }//if(string2[0]=='+'
                    if(string2[0]=='-')//n1/n2 -n3/n4
                    {

                        switch(string2[1])
                        {
                        case '+'://n1/n2 - n3/n4 +n5/n6
                        {
                            int fenzi=n1*n4-n3*n2;
                            int fenmu=n2*n4;
                            if(fenzi<0)
                            {
                                i--;
                                j--;
                                continue;
                            }
                            else
                            {
                                int fenzi1=n1*n4*n6-n3*n2*n6+n5*n2*n4;
                                int fenmu1=n2*n4*n6;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi1,fenmu1,answerfp);
                                break;
                            }
                        }
                        case '-'://n1/n2 -n3/n4 -n5/n6
                        {
                            int fenzi=n1+n4-n3*n2;
                            if(fenzi<0)
                            {
                                i--;
                                j--;
                                continue;
                            }
                            else
                            {
                                int fenzi1=n1*n4*n6-n3*n2*n6-n5*n2*n4;
                                if(fenzi1<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi1,n2*n4*n6,answerfp);
                                }
                            }
                            break;
                        }
                        case '*'://n1/n2 -n3/n4 * n5/n6
                        {
                            int fenzi=n1*n4*n6-n3*n5*n2;
                            int fenmu=n2*n4*n6;
                            if(fenzi<0)
                            {
                                i--;
                                j--;
                                continue;
                            }
                            else
                            {
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                            }
                            break;
                        }
                        case '/'://n1/n2 -n3/n4 / n5/n6
                        {
                            int fenzi=n3*n6;
                            int fenmu=n4*n5;
                            int fenzi1=n1*n4*n5-n3*n2*n6;
                            int fenmu1=n2*n4*n5;
                            if(fenzi1<0)
                            {
                                i--;
                                j--;
                                continue;
                            }
                            else
                            {
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi1,fenmu1,answerfp);
                            }
                            break;
                        }
                        }//switch
                    }//if(string[0]=='-')
                    if(string2[0]=='*')//n1/n2 *n3/n4
                    {
                        switch(string2[1])
                        {
                        case '+'://n1/n2 * n3/n4 + n5/n6
                        {
                            int fenzi=n1*n3*n6+n5*n2*n4;
                            int fenmu=n2*n4*n6;
                            fprintf(fp,"%d. ",j);
                            main_floatchu=int_chuFa(n1,n2,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," %c ",string2[0]);
                            main_floatchu=int_chuFa(n3,n4,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," %c ",string2[1]);
                            main_floatchu=int_chuFa(n5,n6,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," = \n");
                            fprintf(answerfp,"%d. ",i);
                            zhenfenshu(fenzi,fenmu,answerfp);
                            break;
                        }
                        case '-'://n1/n2 * n3/n4 - n5/n6
                        {
                            int fenzi=n1*n3*n6-n5*n2*n4;
                            int fenmu=n2*n4*n6;
                            if(fenzi<0)
                            {
                                i--;
                                j--;
                                continue;
                            }
                            else
                            {
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                            }
                            break;
                        }
                        case '*'://n1/n2 * n3/n4 * n5/n6
                        {
                            int fenzi=n1*n3*n5;
                            int fenmu=n2*n4*n6;
                            fprintf(fp,"%d. ",j);
                            main_floatchu=int_chuFa(n1,n2,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," %c ",string2[0]);
                            main_floatchu=int_chuFa(n3,n4,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," %c ",string2[1]);
                            main_floatchu=int_chuFa(n5,n6,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," = \n");
                            fprintf(answerfp,"%d. ",i);
                            zhenfenshu(fenzi,fenmu,answerfp);
                            break;
                        }
                        case '/'://n1/n2 * n3/n4 / n5/n6
                        {
                            int fenzi=n1*n3*n6;
                            int fenmu=n2*n4*n5;
                            fprintf(fp,"%d. ",j);
                            main_floatchu=int_chuFa(n1,n2,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," %c ",string2[0]);
                            main_floatchu=int_chuFa(n3,n4,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," %c ",string2[1]);
                            main_floatchu=int_chuFa(n5,n6,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," = \n");
                            fprintf(answerfp,"%d. ",i);
                            zhenfenshu(fenzi,fenmu,answerfp);
                            break;
                        }
                        }//switch
                    }//if(string2[0]=='*')
                    if(string2[0]=='/')//n1/n2  / n3/n4
                    {
                        switch(string2[1])
                        {
                        case '+'://n1/n2 / n3/n4 + n5/n6
                        {
                            int fenzi=n1*n4*n6+n5*n2*n3;
                            int fenmu=n2*n3*n6;
                            fprintf(fp,"%d. ",j);
                            main_floatchu=int_chuFa(n1,n2,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," %c ",string2[0]);
                            main_floatchu=int_chuFa(n3,n4,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," %c ",string2[1]);
                            main_floatchu=int_chuFa(n5,n6,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," = \n");
                            fprintf(answerfp,"%d. ",i);
                            zhenfenshu(fenzi,fenmu,answerfp);
                            break;
                        }
                        case '-'://n1/n2 / n3/n4 - n5/n6
                        {
                            int fenzi=n1*n4*n6-n5*n2*n3;
                            int fenmu=n2*n3*n6;
                            if(fenzi<0)
                            {
                                i--;
                                j--;
                                continue;
                            }
                            else
                            {
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                            }
                            break;
                        }
                        case '*'://n1/n2 / n3/n4 * n5/n6
                        {
                            int fenzi=n1*n4*n5;
                            int fenmu=n2*n3*n6;
                            fprintf(fp,"%d. ",j);
                            main_floatchu=int_chuFa(n1,n2,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," %c ",string2[0]);
                            main_floatchu=int_chuFa(n3,n4,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," %c ",string2[1]);
                            main_floatchu=int_chuFa(n5,n6,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," = \n");
                            fprintf(answerfp,"%d. ",i);
                            zhenfenshu(fenzi,fenmu,answerfp);
                            break;
                        }
                        case '/'://n1/n2 / n3/n4 / n5/n6
                        {
                            int fenzi=n1*n4*n6;
                            int fenmu=n2*n3*n5;
                            fprintf(fp,"%d. ",j);
                            main_floatchu=int_chuFa(n1,n2,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," %c ",string2[0]);
                            main_floatchu=int_chuFa(n3,n4,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," %c ",string2[1]);
                            main_floatchu=int_chuFa(n5,n6,num);
                            if(num[1]==1)
                            {
                                fprintf(fp,"%d",num[0]);
                            }
                            else
                            {
                                fprintf(fp,"%d/%d",num[0],num[1]);
                            }
                            fprintf(fp," = \n");
                            fprintf(answerfp,"%d. ",i);
                            zhenfenshu(fenzi,fenmu,answerfp);
                            break;
                        }
                        }//switch
                    }//if(string[0]=='/')
/*第一个操作数*/    main_floatchu=int_chuFa(n1,n2,num);
                    itoa(num[0],src1,10);
                    itoa(num[1],src2,10);
                    strcat(src1,"/");strcat(src1,src2);
					strcpy(numbers[0],src1);
					op[0]=string2[0]; 
/*第一个操作数*/ 	main_floatchu=int_chuFa(n3,n4,num);
					itoa(num[0],src1,10);
                    itoa(num[1],src2,10);
                    strcat(src1,"/");strcat(src1,src2);
					strcpy(numbers[1],src1);
					op[1]=string2[1]; 
/*第一个操作数*/ 	main_floatchu=int_chuFa(n5,n6,num);
					itoa(num[0],src1,10);
                    itoa(num[1],src2,10);
                    strcat(src1,"/");strcat(src1,src2);
					strcpy(numbers[2],src1);
                }//a==2
                if(a == 3)
                {
                    if(string2[0]=='+')//n1/n2 +n3/n4
                    {
                        if(string2[1]=='+')  //n1/n2 + n3/n4 + n5/n6
                        {
                            switch(string2[2])
                            {
                            case '+':   //n1/n2 +n3/n4 +n5/n6 +n7/n8
                            {
                                int fenzi=n1*n4*n6*n8+n3*n2*n6*n8+n5*n2*n4*n8+n7*n2*n4*n6;
                                int fenmu=n2*n4*n6*n8;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);//+
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);//+
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);//+
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }
                            case '-'://n1/n2 +n3/n4 +n5/n6 -n7/n8
                            {
                                int fenzi=n1*n4*n6*n8+n3*n2*n6*n8+n5*n2*n4*n8-n7*n2*n4*n6;
                                int fenmu=n2*n4*n6*n8;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,fenmu,answerfp);
                                }
                                break;
                            }
                            case '*'://n1/n2 +n3/n4 +(n5/n6 * n7/n8)
                            {
                                int fenzi=n1*n4*n6*n8+n3*n2*n6*n8+n5*n7;
                                int fenmu=n2*n4*n6*n8;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }
                            case '/'://n1/n2 +n3/n4 +(n5/n6 / n7/n8)=n5*n8/n6*n7
                            {
                                int fenzi=n1*n4*n6*n7+n3*n2*n6*n7+n5*n8*n2*n4;
                                int fenmu=n2*n4*n6*n7;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }

                            }//switch
                        }//string2[1]
                        if(string2[1]=='-')
                        {
                            switch(string2[2])
                            {
                            case '+'://n1/n2 +n3/n4 -n5/n6 +n7/n8
                            {
                                int fenzi=n1*n4*n6*n8+n3*n2*n6*n8-n5*n2*n4*n8+n7*n2*n4*n6;
                                int fenmu=n2*n4*n6*n8;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,fenmu,answerfp);
                                }
                                break;
                            }
                            case '-'://n1/n2 +n3/n4 -n5/n6 -n7/n8
                            {
                                int fenzi=n1*n4*n6+n3*n2*n6-n5*n2*n4;
                                int fenmu=n2*n4*n6*n8;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenzi1=n1*n4*n6*n8+n3*n2*n6*n8-n5*n2*n4*n8-n7*n2*n4*n6;
                                    if(fenzi1<0)
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d. ",j);
                                        main_floatchu=int_chuFa(n1,n2,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[0]);
                                        main_floatchu=int_chuFa(n3,n4,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[1]);
                                        main_floatchu=int_chuFa(n5,n6,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[2]);
                                        main_floatchu=int_chuFa(n7,n8,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," = \n");
                                        fprintf(answerfp,"%d. ",i);
                                        zhenfenshu(fenzi1,fenmu,answerfp);
                                    }
                                }
                                break;
                            }
                            case '*'://n1/n2 +n3/n4 - (n5/n6 *n7/n8)
                            {
                                int fenzi=n1*n4*n6*n8+n3*n2*n6*n8-n5*n7*n2*n4;
                                int fenmu=n2*n4*n6*n8;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,fenmu,answerfp);
                                }
                                break;
                            }
                            case '/'://n1/n2 +n3/n4 -(n5/n6 / n7/n8)
                            {
                                int fenzi=n1*n4*n6*n7+n3*n2*n6*n7-n5*n8*n2*n4;
                                int fenmu=n2*n4*n6*n7;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,fenmu,answerfp);
                                }
                                break;
                            }
                            }//switch
                        }//string2[1]
                        if(string2[1]=='*')
                        {
                            switch(string2[2])
                            {
                            case '+': //n1/n2 +n3/n4 *n5/n6 +n7/n8
                            {
                                int fenzi=n1*n4*n6*n8+n3*n5*n2*n8+n7*n2*n4*n6;
                                int fenmu=n2*n4*n6*n8;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }
                            case '-': //n1/n2 +n3/n4 *n5/n6 - n7/n8
                            {
                                int fenzi=n1*n4*n6*n8+n3*n5*n2*n8-n7*n2*n4*n6;
                                int fenmu=n2*n4*n6*n8;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,fenmu,answerfp);
                                }
                                break;
                            }
                            case '*'://n1/n2 +n3/n4 *n5/n6 * n7/n8
                            {
                                int fenzi = n1*n4*n6*n8+n3*n5*n7*n2;
                                int fenmu = n2*n4*n6*n8;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }
                            case '/'://n1/n2 +n3/n4 *n5/n6 / n7/n8
                            {
                                int fenzi = n1*n4*n6*n7+n3*n5*n8*n2;
                                int fenmu = n2*n4*n6*n7;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }
                            }//switch
                        }//string2[1]
                        if(string2[1]=='/')
                        {
                            switch(string2[2])
                            {
                            case '+'://n1/n2 +n3/n4 / n5/n6 +n7/n8
                            {
                                int fenzi = n1*n4*n5*n8+n3*n6*n8*n2+n7*n2*n4*n5;
                                int fenmu = n2*n4*n5*n8;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }
                            case '-'://n1/n2 +n3/n4 / n5/n6 -n7/n8
                            {
                                int fenzi=n1*n4*n5*n8-n3*n6*n2*n8-n7*n2*n4*n5;
                                int fenmu=n2*n4*n5*n8;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenzi = n1*n4*n6*n7+n3*n5*n8*n2;
                                    int fenmu = n2*n4*n6*n7;
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,fenmu,answerfp);
                                }
                                break;
                            }
                            case '*'://n1/n2 +n3/n4 / n5/n6 * n7/n8
                            {
                                int fenzi = n1*n4*n5*n8+n3*n6*n7*n2;
                                int fenmu = n2*n4*n5*n8;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }
                            case '/'://n1/n2 +n3/n4 / n5/n6 / n7/n8
                            {
                                int fenzi = n1*n4*n5*n7+n3*n6*n8*n2;
                                int fenmu = n2*n4*n5*n7;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }
                            }//switch
                        }//string2[1]
                    }//string2[0]

                    if(string2[0]=='-')//n1/n2 -n3/n4
                    {
                        if(string2[1]=='+')//n1/n2 -n3/n4 + n5/n6
                        {
                            switch(string2[2])
                            {
                            case '+'://n1/n2 -n3/n4 + n5/n6 +n7/n8
                            {
                                int fenzi=n1*n4-n3*n2;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenzi1=n1*n4*n6*n8-n3*n2*n6*n8+n5*n2*n4*n8+n7*n2*n4*n6;
                                    int fenmu=n2*n4*n6*n8;
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi1,fenmu,answerfp);
                                }
                                break;
                            }
                            case '-'://n1/n2 -n3/n4 + n5/n6 -n7/n8
                            {
                                int fenzi=n1*n4-n3*n2;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenzi1=n1*n4*n6*n8-n3*n2*n6*n8+n5*n2*n4*n8-n7*n2*n4*n6;
                                    if(fenzi1<0)
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else
                                    {
                                        int fenmu=n2*n4*n6*n8;
                                        fprintf(fp,"%d. ",j);
                                        main_floatchu=int_chuFa(n1,n2,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[0]);
                                        main_floatchu=int_chuFa(n3,n4,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[1]);
                                        main_floatchu=int_chuFa(n5,n6,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[2]);
                                        main_floatchu=int_chuFa(n7,n8,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," = \n");
                                        fprintf(answerfp,"%d. ",i);
                                        zhenfenshu(fenzi1,fenmu,answerfp);
                                    }
                                }
                                break;
                            }
                            case '*'://n1/n2 -n3/n4 + n5/n6 *n7/n8
                            {
                                int fenzi=n1*n4-n3*n2;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenzi1=n1*n4*n6*n8-n3*n2*n6*n8+n5*n7*n2*n4;
                                    int fenmu=n2*n4*n6*n8;
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi1,fenmu,answerfp);
                                }
                                break;
                            }
                            case '/'://n1/n2 -n3/n4 + n5/n6 / n7/n8
                            {
                                int fenzi=n1*n4-n3*n2;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenzi1=n1*n4*n6*n7-n3*n2*n6*n7+n5*n2*n4*n8;
                                    int fenmu=n2*n4*n6*n7;
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi1,fenmu,answerfp);
                                }
                                break;
                            }
                            }//switch
                        }//string2[1]
                        if(string2[1]=='-')//n1/n2 -n3/n4 - n5/n6
                        {
                            switch(string2[2])
                            {
                            case '+'://n1/n2 -n3/n4 - n5/n6 + n7/n8
                            {
                                int fenzi=n1*n4-n2*n3;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenzi1=n1*n4*n6-n3*n2*n6-n5*n2*n4;
                                    if(fenzi1<0)
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else
                                    {
                                        int fenzi2=n1*n4*n6*n8-n3*n2*n6*n8-n5*n2*n4*n8+n7*n2*n4*n6;
                                        int fenmu=n2*n4*n6*n8;
                                        fprintf(fp,"%d. ",j);
                                        main_floatchu=int_chuFa(n1,n2,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[0]);
                                        main_floatchu=int_chuFa(n3,n4,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[1]);
                                        main_floatchu=int_chuFa(n5,n6,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[2]);
                                        main_floatchu=int_chuFa(n7,n8,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," = \n");
                                        fprintf(answerfp,"%d. ",i);
                                        zhenfenshu(fenzi2,fenmu,answerfp);
                                    }
                                }
                                break;
                            }
                            case '-'://n1/n2 -n3/n4 - n5/n6 - n7/n8
                            {
                                int fenzi=n1*n4-n2*n3;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenzi1=n1*n4*n6-n3*n2*n6-n5*n2*n4;
                                    if(fenzi1<0)
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else
                                    {
                                        int fenzi2=n1*n4*n6*n8-n3*n2*n6*n8-n5*n2*n4*n8-n7*n2*n4*n6;
                                        if(fenzi2<0)
                                        {
                                            i--;
                                            j--;
                                            continue;
                                        }
                                        else
                                        {
                                            int fenmu=n2*n4*n6*n8;
                                            fprintf(fp,"%d. ",j);
                                            main_floatchu=int_chuFa(n1,n2,num);
                                            if(num[1]==1)
                                            {
                                                fprintf(fp,"%d",num[0]);
                                            }
                                            else
                                            {
                                                fprintf(fp,"%d/%d",num[0],num[1]);
                                            }
                                            fprintf(fp," %c ",string2[0]);
                                            main_floatchu=int_chuFa(n3,n4,num);
                                            if(num[1]==1)
                                            {
                                                fprintf(fp,"%d",num[0]);
                                            }
                                            else
                                            {
                                                fprintf(fp,"%d/%d",num[0],num[1]);
                                            }
                                            fprintf(fp," %c ",string2[1]);
                                            main_floatchu=int_chuFa(n5,n6,num);
                                            if(num[1]==1)
                                            {
                                                fprintf(fp,"%d",num[0]);
                                            }
                                            else
                                            {
                                                fprintf(fp,"%d/%d",num[0],num[1]);
                                            }
                                            fprintf(fp," %c ",string2[2]);
                                            main_floatchu=int_chuFa(n7,n8,num);
                                            if(num[1]==1)
                                            {
                                                fprintf(fp,"%d",num[0]);
                                            }
                                            else
                                            {
                                                fprintf(fp,"%d/%d",num[0],num[1]);
                                            }
                                            fprintf(fp," = \n");
                                            fprintf(answerfp,"%d. ",i);
                                            zhenfenshu(fenzi2,fenmu,answerfp);
                                        }
                                    }
                                }
                                break;
                            }
                            case '*'://n1/n2 -n3/n4 - n5/n6 * n7/n8
                            {
                                int fenzi=n1*n4-n2*n3;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenzi1=n1*n4*n6*n8-n3*n2*n6*n8-n5*n7*n2*n4;
                                    if(fenzi1<0)
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else
                                    {
                                        int fenmu=n2*n4*n6*n8;
                                        fprintf(fp,"%d. ",j);
                                        main_floatchu=int_chuFa(n1,n2,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[0]);
                                        main_floatchu=int_chuFa(n3,n4,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[1]);
                                        main_floatchu=int_chuFa(n5,n6,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[2]);
                                        main_floatchu=int_chuFa(n7,n8,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," = \n");
                                        fprintf(answerfp,"%d. ",i);
                                        zhenfenshu(fenzi1,fenmu,answerfp);
                                    }
                                }
                                break;
                            }
                            case '/'://n1/n2 -n3/n4 - n5/n6 / n7/n8
                            {
                                int fenzi=n1*n4-n2*n3;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenzi1=n1*n4*n6*n7-n3*n2*n6*n7-n5*n8*n2*n4;
                                    if(fenzi1<0)
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else
                                    {
                                        int fenmu=n2*n4*n6*n7;
                                        fprintf(fp,"%d. ",j);
                                        main_floatchu=int_chuFa(n1,n2,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[0]);
                                        main_floatchu=int_chuFa(n3,n4,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[1]);
                                        main_floatchu=int_chuFa(n5,n6,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[2]);
                                        main_floatchu=int_chuFa(n7,n8,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," = \n");
                                        fprintf(answerfp,"%d. ",i);
                                        zhenfenshu(fenzi1,fenmu,answerfp);
                                    }
                                }
                                break;
                            }
                            }//switch
                        }//string2[1]
                        if(string2[1]=='*')//n1/n2 - n3/n4 * n5/n6
                        {
                            switch(string2[2])
                            {
                            case '+'://n1/n2 - n3/n4 * n5/n6 + n7/n8
                            {
                                int fenzi=n1*n4*n6-n3*n5*n2;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenzi1=n1*n4*n6*n8-n3*n5*n2*n8+n7*n2*n4*n6;
                                    int fenmu=n2*n4*n6*n8;
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi1,fenmu,answerfp);
                                }
                                break;
                            }
                            case '-'://n1/n2 - n3/n4 * n5/n6 - n7/n8
                            {
                                int fenzi=n1*n4*n6-n3*n5*n2;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenzi1=n1*n4*n6*n8-n3*n5*n2*n8-n7*n2*n4*n6;
                                    if(fenzi1<0)
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else
                                    {
                                        int fenmu=n2*n4*n6*n8;
                                        fprintf(fp,"%d. ",j);
                                        main_floatchu=int_chuFa(n1,n2,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[0]);
                                        main_floatchu=int_chuFa(n3,n4,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[1]);
                                        main_floatchu=int_chuFa(n5,n6,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[2]);
                                        main_floatchu=int_chuFa(n7,n8,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," = \n");
                                        fprintf(answerfp,"%d. ",i);
                                        zhenfenshu(fenzi1,fenmu,answerfp);
                                    }
                                }
                                break;
                            }
                            case '*'://n1/n2 - n3/n4 * n5/n6 * n7/n8
                            {
                                int fenzi = n1*n4*n6*n8-n3*n5*n7*n2;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenmu=n2*n4*n6*n8;
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,fenmu,answerfp);
                                }
                                break;
                            }
                            case '/'://n1/n2 - n3/n4 * n5/n6 / n7/n8
                            {
                                int fenzi = n1*n4*n6*n7-n3*n5*n8*n2;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenmu=n2*n4*n6*n7;
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,fenmu,answerfp);
                                }
                                break;
                            }

                            }//switch
                        }//string2[1]
                        if(string2[1]=='/')//n1/n2 -n3/n4 /n5/n6
                        {
                            switch(string2[2])
                            {
                            case '+'://n1/n2 -n3/n4 / n5/n6 + n7/n8
                            {
                                int fenzi=n1*n4*n5-n3*n6*n2;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenzi1=n1*n4*n5*n8-n3*n6*n2*n8+n7*n2*n4*n5;
                                    int fenmu=n2*n4*n5*n8;
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi1,fenmu,answerfp);
                                }
                                break;
                            }
                            case '-'://n1/n2 -n3/n4 / n5/n6 - n7/n8
                            {
                                int fenzi=n1*n4*n5-n3*n6*n2;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenzi1=n1*n4*n5*n8-n3*n5*n2*n8-n7*n2*n4*n5;
                                    int fenmu=n2*n4*n5*n8;
                                    if(fenzi1<0)
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d. ",j);
                                        main_floatchu=int_chuFa(n1,n2,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[0]);
                                        main_floatchu=int_chuFa(n3,n4,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[1]);
                                        main_floatchu=int_chuFa(n5,n6,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[2]);
                                        main_floatchu=int_chuFa(n7,n8,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," = \n");
                                        fprintf(answerfp,"%d. ",i);
                                        zhenfenshu(fenzi,fenmu,answerfp);
                                    }
                                }
                                break;
                            }
                            case '*'://n1/n2 -n3/n4 / n5/n6 * n7/n8
                            {
                                int fenzi=n1*n4*n5*n8-n3*n6*n7*n2;
                                int fenmu=n2*n4*n5*n8;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,fenmu,answerfp);
                                }
                                break;
                            }
                            case '/'://n1/n2 -n3/n4 / n5/n6 / n7/n8
                            {
                                int fenzi=n1*n4*n5*n7-n3*n6*n8*n2;
                                int fenmu=n2*n4*n5*n7;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,fenmu,answerfp);
                                }
                                break;
                            }

                            }//switch
                        }//string2[1]
                    }//string2[0]

                    if(string2[0]=='*')//n1/n2 * n3/n4
                    {
                        if(string2[1]=='+')//n1/n2 *n3/n4 +n5/n6
                        {
                            switch(string2[2])
                            {
                            case '+'://n1/n2 *n3/n4 +n5/n6 + n7/n8
                            {
                                int fenzi=n1*n3*n6*n8+n5*n2*n4*n8+n7*n2*n4*n6;
                                int fenmu=n2*n4*n6*n8;
                                fprintf(fp,"%d. ",j);
                                main_floatchu = int_chuFa(n1,n2,num);//num[0]分子，nu'm[1]分子
                                if(num[1] == 1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu = int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }
                            case '-'://n1/n2 *n3/n4 +n5/n6 - n7/n8
                            {
                                int fenzi=n1*n3*n6*n8+n5*n2*n4*n8-n7*n2*n4*n6;
                                int fenmu=n2*n4*n6*n8;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,fenmu,answerfp);
                                }
                                break;
                            }
                            case '*'://n1/n2 *n3/n4 +n5/n6 * n7/n8
                            {
                                int fenzi=n1*n3*n6*n8+n5*n7*n2*n4;
                                int fenmu=n2*n4*n6*n8;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }
                            case '/'://n1/n2 *n3/n4 +n5/n6 / n7/n8
                            {
                                int fenzi=n1*n3*n6*n7+n5*n8*n2*n4;
                                int fenmu=n2*n4*n6*n7;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }

                            }//switch
                        }//string2[1]
                        if(string2[1]=='-')//n1/n2 *n3/n4 -n5/n6
                        {
                            switch(string2[2])
                            {
                            case '+'://n1/n2 *n3/n4 -n5/n6 + n7/n8
                            {
                                int fenzi=n1*n3*n6-n5*n2*n4;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenzi1=n1*n3*n6*n8-n5*n2*n4*n8+n7*n2*n4*n6;
                                    int fenmu=n2*n4*n6*n8;
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi1,fenmu,answerfp);
                                }
                                break;
                            }
                            case '-'://n1/n2 *n3/n4 -n5/n6 - n7/n8
                            {
                                int fenzi=n1*n3*n6-n5*n2*n4;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenzi1=n1*n3*n6*n8-n5*n2*n4*n8-n7*n2*n4*n6;
                                    int fenmu=n2*n4*n6*n8;
                                    if(fenzi1<0)
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d. ",j);
                                        main_floatchu=int_chuFa(n1,n2,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[0]);
                                        main_floatchu=int_chuFa(n3,n4,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[1]);
                                        main_floatchu=int_chuFa(n5,n6,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[2]);
                                        main_floatchu=int_chuFa(n7,n8,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," = \n");
                                        fprintf(answerfp,"%d. ",i);
                                        zhenfenshu(fenzi1,fenmu,answerfp);
                                    }
                                }
                                break;
                            }
                            case '*'://n1/n2 *n3/n4 -n5/n6 * n7/n8
                            {
                                int fenzi=n1*n3*n6*n8-n5*n7*n2*n4;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenmu=n2*n4*n6*n8;
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,fenmu,answerfp);
                                }
                                break;
                            }
                            case '/'://n1/n2 *n3/n4 -n5/n6 / n7/n8
                            {
                                int fenzi=n1*n3*n6*n7-n5*n8*n2*n4;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenmu=n2*n4*n6*n7;
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,fenmu,answerfp);
                                }
                                break;
                            }

                            }//switch
                        }//string2[1]
                        if(string2[1]=='*')  //n1/n2 *n3/n4 *n5/n6
                        {
                            switch(string2[2])
                            {
                            case '+'://n1/n2 *n3/n4 *n5/n6 + n7/n8
                            {
                                int fenzi=n1*n3*n5*n8+n7*n2*n4*n6;
                                int fenmu=n2*n4*n6*n8;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }
                            case '-'://n1/n2 *n3/n4 *n5/n6 - n7/n8
                            {
                                int fenzi=n1*n3*n5*n8-n7*n2*n4*n6;
                                int fenmu=n2*n4*n6*n8;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,fenmu,answerfp);
                                }
                                break;
                            }
                            case '*'://n1/n2 *n3/n4 *n5/n6 * n7/n8
                            {
                                int fenzi=n1*n3*n5*n7;
                                int fenmu=n2*n4*n6*n8;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }
                            case '/'://n1/n2 *n3/n4 *n5/n6 / n7/n8
                            {
                                int fenzi=n1*n3*n5*n8;
                                int fenmu=n2*n4*n6*n7;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }
                            }//switch
                        }//string2[1]
                        if(string2[1]=='/')  //n1/n2 *n3/n4 / n5/n6
                        {
                            switch(string2[2])
                            {
                            case '+'://n1/n2 *n3/n4 / n5/n6 + n7/n8
                            {
                                int fenzi=n1*n3*n6*n8+n7*n2*n4*n5;
                                int fenmu=n2*n4*n5*n8;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }
                            case '-'://n1/n2 *n3/n4 / n5/n6 - n7/n8
                            {
                                int fenzi=n1*n3*n6*n8-n7*n2*n4*n5;
                                int fenmu=n2*n4*n5*n8;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,fenmu,answerfp);
                                }
                                break;
                            }
                            case '*'://n1/n2 *n3/n4 / n5/n6 * n7/n8
                            {
                                int fenzi=n1*n3*n6*n7;
                                int fenmu=n2*n4*n5*n8;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }
                            case '/'://n1/n2 *n3/n4 / n5/n6 / n7/n8
                            {
                                int fenzi=n1*n3*n6*n8;
                                int fenmu=n2*n4*n5*n7;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }

                            }//switch
                        }//string2[1]
                    }//string2[0]



                    if(string2[0]=='/')//n1/n2  / n3/n4
                    {
                        if(string2[1]=='+') //n1/n2 / n3/n4 + n5/n6
                        {
                            switch(string2[2])
                            {
                            case '+'://n1/n2 / n3/n4 + n5/n6 + n7/n8
                            {
                                int fenzi=n1*n4*n6*n8+n5*n2*n3*n8+n7*n2*n3*n6;
                                int fenmu=n2*n3*n6*n8;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }
                            case '-'://n1/n2 / n3/n4 + n5/n6 - n7/n8
                            {
                                int fenzi=n1*n4*n6*n8+n5*n2*n3*n8-n7*n2*n3*n6;
                                int fenmu=n2*n3*n6*n8;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,fenmu,answerfp);
                                }
                                break;
                            }
                            case '*'://n1/n2 / n3/n4 + n5/n6 * n7/n8
                            {
                                int fenzi=n1*n4*n6*n8+n5*n7*n2*n3;
                                int fenmu=n2*n3*n6*n8;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }
                            case '/'://n1/n2 / n3/n4 + n5/n6 / n7/n8
                            {
                                int fenzi=n1*n4*n6*n7+n5*n8*n2*n3;
                                int fenmu=n2*n3*n6*n7;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }

                            }//switch
                        }//string2[1]
                        if(string2[1]=='-')
                        {
                            switch(string2[2])
                            {
                            case '+'://n1/n2 / n3/n4 - n5/n6 + n7/n8
                            {
                                int fenzi=n1*n4*n6-n5*n2*n3;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenzi1=n1*n4*n6*n8-n5*n2*n3*n8+n7*n2*n3*n6;
                                    int fenmu=n2*n3*n6*n8;
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi1,fenmu,answerfp);
                                }
                                break;
                            }
                            case '-'://n1/n2 / n3/n4 - n5/n6 - n7/n8
                            {
                                int fenzi=n1*n4*n6-n5*n2*n3;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenzi1=n1*n4*n6*n8-n5*n2*n3*n8-n7*n2*n3*n6;
                                    int fenmu=n2*n3*n6*n8;
                                    if(fenzi1<0)
                                    {
                                        i--;
                                        j--;
                                        continue;
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d. ",j);
                                        main_floatchu=int_chuFa(n1,n2,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[0]);
                                        main_floatchu=int_chuFa(n3,n4,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[1]);
                                        main_floatchu=int_chuFa(n5,n6,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," %c ",string2[2]);
                                        main_floatchu=int_chuFa(n7,n8,num);
                                        if(num[1]==1)
                                        {
                                            fprintf(fp,"%d",num[0]);
                                        }
                                        else
                                        {
                                            fprintf(fp,"%d/%d",num[0],num[1]);
                                        }
                                        fprintf(fp," = \n");
                                        fprintf(answerfp,"%d. ",i);
                                        zhenfenshu(fenzi1,fenmu,answerfp);
                                    }
                                }
                                break;
                            }
                            case '*'://n1/n2 / n3/n4 - n5/n6 * n7/n8
                            {
                                int fenzi=n1*n4*n6*n8-n5*n7*n2*n3;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenmu=n2*n3*n6*n8;
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,fenmu,answerfp);
                                }
                                break;
                            }
                            case '/'://n1/n2 / n3/n4 - n5/n6 / n7/n8
                            {
                                int fenzi=n1*n4*n6*n7-n5*n8*n2*n3;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    int fenmu=n2*n3*n6*n7;
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,fenmu,answerfp);
                                }
                                break;
                            }
                            }//switch
                        }//string2[1]
                        if(string2[1]=='*')
                        {
                            switch(string2[2])
                            {
                            case '+'://n1/n2 / n3/n4 * n5/n6 + n7/n8
                            {
                                int fenzi=n1*n4*n5*n8+n7*n2*n3*n6;
                                int fenmu=n2*n3*n6*n8;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }
                            case '-'://n1/n2 / n3/n4 * n5/n6 - n7/n8
                            {
                                int fenzi=n1*n4*n5*n8-n7*n2*n3*n6;
                                int fenmu=n2*n3*n6*n8;
                                if(fenzi<0)
                                {
                                    i--;
                                    j--;
                                    continue;
                                }
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,fenmu,answerfp);
                                }
                                break;
                            }
                            case '*'://n1/n2 / n3/n4 * n5/n6 * n7/n8
                            {
                                int fenzi=n1*n4*n5*n7;
                                int fenmu=n2*n3*n6*n8;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }
                            case '/'://n1/n2 / n3/n4 * n5/n6 / n7/n8
                            {
                                int fenzi=n1*n4*n5*n8;
                                int fenmu=n2*n3*n6*n7;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }

                            }//switch
                        }//string2[1]
                        if(string2[1]=='/')
                        {
                            switch(string2[2])
                            {
                            case '+'://n1/n2 / n3/n4 / n5/n6 + n7/n8
                            {
                                int fenzi=n1*n4*n6*n8+n7*n2*n3*n5;
                                int fenmu=n2*n3*n5*n8;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }
                            case '-'://n1/n2 / n3/n4 / n5/n6 - n7/n8
                            {
                                int fenzi=n1*n4*n6*n8-n7*n2*n3*n5;
                                int fenmu=n2*n3*n5*n8;
                                if(fenzi<0)
                                {i--;j--;continue;}
                                else
                                {
                                    fprintf(fp,"%d. ",j);
                                    main_floatchu=int_chuFa(n1,n2,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[0]);
                                    main_floatchu=int_chuFa(n3,n4,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[1]);
                                    main_floatchu=int_chuFa(n5,n6,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," %c ",string2[2]);
                                    main_floatchu=int_chuFa(n7,n8,num);
                                    if(num[1]==1)
                                    {
                                        fprintf(fp,"%d",num[0]);
                                    }
                                    else
                                    {
                                        fprintf(fp,"%d/%d",num[0],num[1]);
                                    }
                                    fprintf(fp," = \n");
                                    fprintf(answerfp,"%d. ",i);
                                    zhenfenshu(fenzi,fenmu,answerfp);
                                }
                                break;
                            }
                            case '*'://n1/n2 / n3/n4 / n5/n6 * n7/n8
                            {
                                int fenzi=n1*n4*n6*n7;
                                int fenmu=n2*n3*n5*n8;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }
                            case '/'://n1/n2 / n3/n4 / n5/n6 / n7/n8
                            {
                                int fenzi=n1*n4*n6*n8;
                                int fenmu=n2*n3*n5*n7;
                                fprintf(fp,"%d. ",j);
                                main_floatchu=int_chuFa(n1,n2,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[0]);
                                main_floatchu=int_chuFa(n3,n4,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[1]);
                                main_floatchu=int_chuFa(n5,n6,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," %c ",string2[2]);
                                main_floatchu=int_chuFa(n7,n8,num);
                                if(num[1]==1)
                                {
                                    fprintf(fp,"%d",num[0]);
                                }
                                else
                                {
                                    fprintf(fp,"%d/%d",num[0],num[1]);
                                }
                                fprintf(fp," = \n");
                                fprintf(answerfp,"%d. ",i);
                                zhenfenshu(fenzi,fenmu,answerfp);
                                break;
                            }

                            }//switch
                        }//string2[1]
                    }//string2[0]
/*第一个操作数*/    main_floatchu=int_chuFa(n1,n2,num);
                    itoa(num[0],src1,10);
                    itoa(num[1],src2,10);
                    strcat(src1,"/");strcat(src1,src2);
					strcpy(numbers[0],src1); 
					op[0]=string2[0]; 
/*第二个操作数*/ 	main_floatchu=int_chuFa(n3,n4,num);
					itoa(num[0],src1,10);
                    itoa(num[1],src2,10);
                    strcat(src1,"/");strcat(src1,src2);
					strcpy(numbers[1],src1);
					op[1]=string2[1]; 
/*第三个操作数*/ 	main_floatchu=int_chuFa(n5,n6,num);
					itoa(num[0],src1,10);
                    itoa(num[1],src2,10);
                    strcat(src1,"/");strcat(src1,src2);
					strcpy(numbers[2],src1);
					op[2]=string2[2]; 
/*第四个操作数*/ 	main_floatchu=int_chuFa(n7,n8,num);
					itoa(num[0],src1,10);
                    itoa(num[1],src2,10);
                    strcat(src1,"/");strcat(src1,src2);
					strcpy(numbers[3],src1);
                }//a==3
            }//for
        }//x==2
    }//r==1

    if(r==2)
    {
        checkAnswer();
    }
    return 0;

}//int main()
